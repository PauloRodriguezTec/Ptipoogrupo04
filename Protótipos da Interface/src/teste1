<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Gestão Escolar</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f4f4f4; margin: 0; padding: 20px; }
        .container { background-color: #fff; padding: 30px; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); max-width: 900px; margin: 0 auto; }
        
        /* Estilos da Autenticação (Pré-condição) */
        #login-screen { text-align: center; padding: 50px; }
        #login-screen button { padding: 10px 20px; background-color: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; }
        #login-screen button:hover { background-color: #0056b3; }
        
        /* Estilos do Sistema */
        #system-dashboard { display: none; }
        .tabs { display: flex; border-bottom: 2px solid #ccc; margin-bottom: 20px; }
        .tab-button { padding: 10px 20px; cursor: pointer; border: none; background: #eee; border-radius: 8px 8px 0 0; margin-right: 5px; transition: background-color 0.3s; }
        .tab-button.active { background-color: #007bff; color: white; border-bottom: 2px solid #007bff; }
        .tab-content { display: none; padding: 20px 0; border: 1px solid #ccc; border-top: none; padding: 20px; border-radius: 0 0 8px 8px; background-color: #f9f9f9; }
        .tab-content.active { display: block; }
        
        /* Estilos dos Formulários */
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 5px; font-weight: bold; }
        .form-group input, .form-group select { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        .btn-salvar { padding: 10px 15px; background-color: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer; margin-right: 10px; }
        .btn-salvar:hover { background-color: #1e7e34; }
        .btn-sair { padding: 10px 15px; background-color: #dc3545; color: white; border: none; border-radius: 4px; cursor: pointer; }
        .btn-sair:hover { background-color: #c82333; }

        /* Mensagens */
        .message { padding: 10px; margin-top: 15px; border-radius: 4px; font-weight: bold; display: none; }
        .message.success { background-color: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .message.error { background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
    </style>
</head>
<body>

    <div class="container">
        
        <div id="login-screen">
            <h2>Sistema de Gestão Escolar</h2>
            <p>O usuário precisa estar autenticado para acessar o sistema.</p>
            <button onclick="autenticar()">Simular Login (Secretaria Escolar)</button>
        </div>

        <div id="system-dashboard">
            <h1>Bem-vindo(a), a Secretaria Escolar!</h1>
            
            <div class="tabs">
                <button class="tab-button active" onclick="openTab(event, 'alunos')">Alunos</button>
                <button class="tab-button" onclick="openTab(event, 'professores')">Professores</button>
                <button class="tab-button" onclick="openTab(event, 'disciplinas')">Disciplinas</button>
                <button class="tab-button" onclick="openTab(event, 'matriculas')">Matrículas</button>
                <button class="tab-button" onclick="openTab(event, 'contratos')">Contratos</button>
                <button class="btn-sair" style="margin-left: auto;" onclick="logout()">Sair</button>
            </div>

            <div id="alunos" class="tab-content active">
                <h3>Cadastrar Aluno</h3>
                <form id="form-aluno">
                    <div class="form-group">
                        <label for="aluno-cpf">CPF:</label>
                        <input type="text" id="aluno-cpf" required maxlength="14" oninput="formatCPF(this)">
                    </div>
                    <div class="form-group">
                        <label for="aluno-nome">Nome Completo:</label>
                        <input type="text" id="aluno-nome" required>
                    </div>
                    <div class="form-group">
                        <label for="aluno-dataNascimento">Data de Nascimento:</label>
                        <input type="date" id="aluno-dataNascimento" required>
                    </div>
                    <div class="form-group">
                        <label for="aluno-endereco">Endereço:</label>
                        <input type="text" id="aluno-endereco" required>
                    </div>
                    <div class="form-group">
                        <label for="aluno-telefone">Telefone:</label>
                        <input type="tel" id="aluno-telefone" required maxlength="15" oninput="formatPhone(this)">
                    </div>
                    <div class="form-group">
                        <label for="aluno-email">E-mail:</label>
                        <input type="email" id="aluno-email" required>
                    </div>
                    
                    <button type="button" class="btn-salvar" onclick="cadastrarAluno()">Salvar</button>
                </form>

                <div id="aluno-message" class="message"></div>
            </div>

            <div id="professores" class="tab-content">
                <h3>Cadastrar Professor</h3>
                <form id="form-professor">
                    <div class="form-group">
                        <label for="professor-cpf">CPF:</label>
                        <input type="text" id="professor-cpf" required maxlength="14" oninput="formatCPF(this)">
                    </div>
                    <div class="form-group">
                        <label for="professor-nome">Nome Completo:</label>
                        <input type="text" id="professor-nome" required>
                    </div>
                    <div class="form-group">
                        <label for="professor-dataNascimento">Data de Nascimento:</label>
                        <input type="date" id="professor-dataNascimento" required>
                    </div>
                    <div class="form-group">
                        <label for="professor-endereco">Endereço:</label>
                        <input type="text" id="professor-endereco" required>
                    </div>
                    <div class="form-group">
                        <label for="professor-telefone">Telefone:</label>
                        <input type="tel" id="professor-telefone" required maxlength="15" oninput="formatPhone(this)">
                    </div>
                    <div class="form-group">
                        <label for="professor-email">E-mail:</label>
                        <input type="email" id="professor-email" required>
                    </div>
                    <div class="form-group">
                        <label for="professor-especialidade">Especialidade:</label>
                        <input type="text" id="professor-especialidade" required>
                    </div>
                    
                    <button type="button" class="btn-salvar" onclick="cadastrarProfessor()">Salvar</button>
                </form>
                
                <div id="professor-message" class="message"></div>
            </div>

            <div id="disciplinas" class="tab-content">
                <h3>Módulo Disciplinas</h3>
                <p>Aqui seria implementado o formulário para **Cadastrar Disciplina**.</p>
            </div>
            <div id="matriculas" class="tab-content">
                <h3>Módulo Matrículas</h3>
                <p>Aqui seria implementado o formulário para **Nova Matrícula**.</p>
            </div>
            <div id="contratos" class="tab-content">
                <h3>Módulo Contratos</h3>
                <p>Aqui seria implementado o formulário para **Novo Contrato**.</p>
            </div>

        </div>
    </div>

    <script>
        // Simulação do Banco de Dados
        const db = {
            alunos: [],
            professores: []
        };
        
        // --- Funções de Formatação (Melhoria de UX) ---
        function formatCPF(input) {
            let value = input.value.replace(/\D/g, '');
            if (value.length > 3) value = value.substring(0, 3) + '.' + value.substring(3);
            if (value.length > 7) value = value.substring(0, 7) + '.' + value.substring(7);
            if (value.length > 11) value = value.substring(0, 11) + '-' + value.substring(11, 13);
            input.value = value;
        }

        function formatPhone(input) {
            let value = input.value.replace(/\D/g, '');
            let formated = '';
            if (value.length > 0) formated += '(' + value.substring(0, 2);
            if (value.length > 2) formated += ') ' + value.substring(2, 7);
            if (value.length > 7) formated += '-' + value.substring(7, 11);
            input.value = formated;
        }

        // --- 1. Lógica de Autenticação (Pré-condição) ---
        function autenticar() {
            // A pré-condição é que o usuário deve estar autenticado.
            // Aqui simulamos um login bem-sucedido pela Secretaria Escolar.
            document.getElementById('login-screen').style.display = 'none';
            document.getElementById('system-dashboard').style.display = 'block';
            console.log("Pré-condição atendida: Usuário autenticado.");
        }

        function logout() {
            // Ação do botão "Sair"
            document.getElementById('login-screen').style.display = 'block';
            document.getElementById('system-dashboard').style.display = 'none';
            // Limpa o formulário ativo
            document.querySelectorAll('form').forEach(form => form.reset()); 
            console.log("Botão Sair pressionado. Formulário limpo.");
        }

        // --- 2. Lógica de Navegação entre Abas ---
        function openTab(evt, tabName) {
            // Oculta todos os conteúdos e remove o status 'active' dos botões
            document.querySelectorAll('.tab-content').forEach(tab => tab.style.display = 'none');
            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));

            // Mostra o conteúdo da aba selecionada e ativa o botão
            document.getElementById(tabName).style.display = 'block';
            evt.currentTarget.classList.add('active');
            
            // Limpa as mensagens ao mudar de aba
            document.querySelectorAll('.message').forEach(msg => msg.style.display = 'none');
            // Garante que o formulário ativo seja limpo ao mudar de aba
            document.getElementById('form-aluno').reset();
            document.getElementById('form-professor').reset();
        }

        // --- 3. Funções de Validação ---

        // Valida se o CPF já existe no banco de dados simulado
        function isCpfDuplicated(cpf, type) {
            const cleanedCpf = cpf.replace(/\D/g, '');
            if (type === 'aluno') {
                return db.alunos.some(aluno => aluno.cpf === cleanedCpf);
            } else if (type === 'professor') {
                return db.professores.some(prof => prof.cpf === cleanedCpf);
            }
            return false;
        }

        function displayMessage(elementId, message, type) {
            const messageElement = document.getElementById(elementId);
            messageElement.textContent = message;
            messageElement.className = `message ${type}`;
            messageElement.style.display = 'block';
        }

        function clearFormAndMessage(formId, messageId) {
            document.getElementById(formId).reset();
            // Limpa a mensagem após um pequeno delay para que o usuário a veja
            setTimeout(() => document.getElementById(messageId).style.display = 'none', 5000);
        }

        // --- 4. Lógica de Cadastro de Aluno ---
        function cadastrarAluno() {
            const form = document.getElementById('form-aluno');
            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }

            const cpf = document.getElementById('aluno-cpf').value;
            const cleanedCpf = cpf.replace(/\D/g, '');

            // Validação: Checar duplicidade de CPF
            if (isCpfDuplicated(cpf, 'aluno')) {
                displayMessage('aluno-message', 'CPF já cadastrado. O formulário será limpo para preenchimento correto.', 'error');
                form.reset(); // Limpa o formulário
                return;
            }

            // Coleta os dados para o novo registro
            const novoAluno = {
                cpf: cleanedCpf,
                nomeCompleto: document.getElementById('aluno-nome').value,
                dataNascimento: document.getElementById('aluno-dataNascimento').value,
                endereco: document.getElementById('aluno-endereco').value,
                telefone: document.getElementById('aluno-telefone').value,
                email: document.getElementById('aluno-email').value
            };

            // Pós-condição: Criação da Matrícula e Armazenamento no BD (simulado)
            const numMatricula = 'M' + new Date().getTime().toString().substring(5, 12);
            novoAluno.numMatricula = numMatricula;
            db.alunos.push(novoAluno); // Armazena os dados
            
            // Exibe mensagem de sucesso
            displayMessage('aluno-message', `Aluno(a) cadastrado(a) com sucesso! Matrícula: ${numMatricula}`, 'success');
            clearFormAndMessage('form-aluno', 'aluno-message'); // Limpa o formulário
            console.log("Novo Aluno Cadastrado (Pós-condição):", novoAluno);
        }

        // --- 5. Lógica de Cadastro de Professor ---
        function cadastrarProfessor() {
            const form = document.getElementById('form-professor');
            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }

            const cpf = document.getElementById('professor-cpf').value;
            const cleanedCpf = cpf.replace(/\D/g, '');

            // Validação: Checar duplicidade de CPF
            if (isCpfDuplicated(cpf, 'professor')) {
                displayMessage('professor-message', 'CPF já cadastrado. O formulário será limpo para preenchimento correto.', 'error');
                form.reset(); // Limpa o formulário
                return;
            }

            // Coleta os dados para o novo registro
            const novoProfessor = {
                cpf: cleanedCpf,
                nomeCompleto: document.getElementById('professor-nome').value,
                dataNascimento: document.getElementById('professor-dataNascimento').value,
                endereco: document.getElementById('professor-endereco').value,
                telefone: document.getElementById('professor-telefone').value,
                email: document.getElementById('professor-email').value,
                especialidade: document.getElementById('professor-especialidade').value
            };

            // Armazenamento no BD (simulado)
            db.professores.push(novoProfessor); 

            // Exibe mensagem de sucesso
            displayMessage('professor-message', `Professor(a) cadastrado(a) com sucesso!`, 'success');
            clearFormAndMessage('form-professor', 'professor-message'); // Limpa o formulário
            console.log("Novo Professor Cadastrado:", novoProfessor);
        }

    </script>

</body>
</html>
